{"ast":null,"code":"import _objectSpread from\"/Users/alpacino/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/alpacino/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/alpacino/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alpacino/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useReducer,useContext}from\"react\";import reducer from\"./reducer\";import axios from\"axios\";import{CLEAR_ALERT,DISPLAY_ALERT,REGISTER_USER_BEGIN,REGISTER_USER_SUCCESS,REGISTER_USER_ERROR,LOGIN_USER_BEGIN,LOGIN_USER_SUCCESS,LOGIN_USER_ERROR,LOGOUT_USER,FORGOT_PASSWORD_ERROR,FORGOT_PASSWORD_BEGIN,RESET_PASSWORD_BEGIN,RESET_PASSWORD_ERROR}from\"./actions\";import toast from\"react-hot-toast\";import{jsx as _jsx}from\"react/jsx-runtime\";var token=localStorage.getItem(\"token\");var user=localStorage.getItem(\"user\");var initialState={isLoading:false,showAlert:false,alertText:\"\",alertType:\"\",user:user?JSON.parse(user):null,token:token};var AppContext=/*#__PURE__*/React.createContext();var AppProvider=function AppProvider(_ref){var children=_ref.children;var _useReducer=useReducer(reducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];// axios\nvar authFetch=axios.create({baseURL:\"api/v1\"});authFetch.interceptors.response.use(function(response){return response;},function(error){if(error.response.status===401){logoutUser();}return Promise.reject(error);});var displayAlert=function displayAlert(){dispatch({type:DISPLAY_ALERT});clearAlert();};var passwordAlert=function passwordAlert(){dispatch({type:FORGOT_PASSWORD_ERROR});clearAlert();};var resetAlert=function resetAlert(){dispatch({type:RESET_PASSWORD_ERROR});clearAlert();};var clearAlert=function clearAlert(){setTimeout(function(){dispatch({type:CLEAR_ALERT});},3000);};var addUserToLocalStorage=function addUserToLocalStorage(_ref2){var user=_ref2.user,token=_ref2.token;localStorage.setItem(\"user\",JSON.stringify(user));localStorage.setItem(\"token\",token);};var removeUserFromLocalStorage=function removeUserFromLocalStorage(){localStorage.removeItem(\"token\");localStorage.removeItem(\"user\");};var registerUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(currentUser){var response,_response$data,_user,_token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:REGISTER_USER_BEGIN});_context.prev=1;_context.next=4;return axios.post('/api/v1/auth/register',currentUser);case 4:response=_context.sent;// (response);\n_response$data=response.data,_user=_response$data.user,_token=_response$data.token;dispatch({type:REGISTER_USER_SUCCESS,payload:{user:_user,token:_token}});addUserToLocalStorage({user:_user,token:_token});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);// (error.response);\ndispatch({type:REGISTER_USER_ERROR,payload:{msg:_context.t0.response.data.msg}});case 13:clearAlert();case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function registerUser(_x){return _ref3.apply(this,arguments);};}();var loginUser=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(currentUser){var _yield$axios$post,data,_user2,_token2;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch({type:LOGIN_USER_BEGIN});_context2.prev=1;_context2.next=4;return axios.post('/api/v1/auth/login',currentUser);case 4:_yield$axios$post=_context2.sent;data=_yield$axios$post.data;_user2=data.user,_token2=data.token;dispatch({type:LOGIN_USER_SUCCESS,payload:{user:_user2,token:_token2}});addUserToLocalStorage({user:_user2,token:_token2});_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);dispatch({type:LOGIN_USER_ERROR,payload:{msg:_context2.t0.response.data.msg}});case 14:clearAlert();case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[1,11]]);}));return function loginUser(_x2){return _ref4.apply(this,arguments);};}();var logoutUser=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// await authFetch.get(\"/auth/logout\")\ndispatch({type:LOGOUT_USER});removeUserFromLocalStorage();case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function logoutUser(){return _ref5.apply(this,arguments);};}();var forgotpassword=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(forgotEmail){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch({type:FORGOT_PASSWORD_BEGIN});_context4.prev=1;_context4.next=4;return axios.post('/api/v1/auth/forgotpassword',forgotEmail);case 4:response=_context4.sent;toast.success(response.data);_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](1);toast.error(_context4.t0.response.data);case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[1,8]]);}));return function forgotpassword(_x3){return _ref6.apply(this,arguments);};}();var resetPassword=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(details){var response,_response$data2,status;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:dispatch({type:RESET_PASSWORD_BEGIN});_context5.prev=1;_context5.next=4;return axios.post('/api/v1/auth/updatepassword',details);case 4:response=_context5.sent;_response$data2=response.data(\"see response\",status),status=_response$data2.status;_context5.next=11;break;case 8:_context5.prev=8;_context5.t0=_context5[\"catch\"](1);dispatch({type:RESET_PASSWORD_ERROR,payload:{msg:_context5.t0.response.data.msg}});case 11:case\"end\":return _context5.stop();}}},_callee5,null,[[1,8]]);}));return function resetPassword(_x4){return _ref7.apply(this,arguments);};}();return/*#__PURE__*/_jsx(AppContext.Provider,{value:_objectSpread(_objectSpread({},state),{},{displayAlert:displayAlert,registerUser:registerUser,loginUser:loginUser,logoutUser:logoutUser,passwordAlert:passwordAlert,forgotpassword:forgotpassword,resetPassword:resetPassword,resetAlert:resetAlert}),children:children});};var useAppContext=function useAppContext(){return useContext(AppContext);};export{AppProvider,initialState,useAppContext};","map":{"version":3,"names":["React","useReducer","useContext","reducer","axios","CLEAR_ALERT","DISPLAY_ALERT","REGISTER_USER_BEGIN","REGISTER_USER_SUCCESS","REGISTER_USER_ERROR","LOGIN_USER_BEGIN","LOGIN_USER_SUCCESS","LOGIN_USER_ERROR","LOGOUT_USER","FORGOT_PASSWORD_ERROR","FORGOT_PASSWORD_BEGIN","RESET_PASSWORD_BEGIN","RESET_PASSWORD_ERROR","toast","token","localStorage","getItem","user","initialState","isLoading","showAlert","alertText","alertType","JSON","parse","AppContext","createContext","AppProvider","children","state","dispatch","authFetch","create","baseURL","interceptors","response","use","error","status","logoutUser","Promise","reject","displayAlert","type","clearAlert","passwordAlert","resetAlert","setTimeout","addUserToLocalStorage","setItem","stringify","removeUserFromLocalStorage","removeItem","registerUser","currentUser","post","data","payload","msg","loginUser","forgotpassword","forgotEmail","success","resetPassword","details","useAppContext"],"sources":["/Users/alpacino/Desktop/port/client/src/context/appContext.js"],"sourcesContent":["import React , {  useReducer, useContext } from \"react\";\nimport reducer from \"./reducer\";\nimport axios from \"axios\"\nimport { CLEAR_ALERT, DISPLAY_ALERT ,REGISTER_USER_BEGIN,REGISTER_USER_SUCCESS,REGISTER_USER_ERROR,\nLOGIN_USER_BEGIN,LOGIN_USER_SUCCESS,LOGIN_USER_ERROR, LOGOUT_USER, FORGOT_PASSWORD_ERROR, FORGOT_PASSWORD_BEGIN, RESET_PASSWORD_BEGIN,RESET_PASSWORD_ERROR} from \"./actions\"\nimport toast from \"react-hot-toast\"\n\n\nconst token = localStorage.getItem(\"token\")\nconst user = localStorage.getItem(\"user\")\n\nconst initialState = {\n    isLoading: false,\n    showAlert: false,\n    alertText: \"\",\n    alertType: \"\",\n    user: user? JSON.parse(user):null,\n    token: token,\n}\n\nconst AppContext = React.createContext()\n\nconst AppProvider = ({ children }) => {\n    const [state, dispatch] = useReducer(reducer, initialState)\n    // axios\n    const authFetch = axios.create({\n        baseURL: \"api/v1\",\n    })\n\n    authFetch.interceptors.response.use(\n    (response) => {\n        return response\n    },\n    (error) => {\n        if(error.response.status === 401) {\n            logoutUser()\n        }\n        return Promise.reject(error)\n    }\n    )\n\n    const displayAlert = () => {\n        dispatch({type: DISPLAY_ALERT})\n        clearAlert()\n    }\n\n    const passwordAlert = () => {\n        dispatch({type: FORGOT_PASSWORD_ERROR})\n        clearAlert()\n    }\n    const resetAlert = () => {\n        dispatch({type:  RESET_PASSWORD_ERROR})\n        clearAlert()\n    }\n\n    const clearAlert = () => {\n        setTimeout(() => {\n            dispatch({ type: CLEAR_ALERT})\n        },3000);\n    }\n\n\n\n\n\n    const addUserToLocalStorage = ({user, token, }) => {\n        localStorage.setItem(\"user\", JSON.stringify(user))\n        localStorage.setItem(\"token\", token)\n    }\n\n    const removeUserFromLocalStorage = () => {\n        localStorage.removeItem(\"token\")\n        localStorage.removeItem(\"user\")\n    }\n\n    const registerUser = async (currentUser) => {\n      dispatch({ type: REGISTER_USER_BEGIN })\n      try {\n        const response = await axios.post('/api/v1/auth/register', currentUser)\n        // (response);\n        const { user, token } = response.data\n        dispatch ({\n            type: REGISTER_USER_SUCCESS,\n            payload: { user, token},\n        })\n        addUserToLocalStorage({user, token})\n      } catch (error) {\n        // (error.response);\n        dispatch({\n            type: REGISTER_USER_ERROR,\n            payload: { msg: error.response.data.msg}\n        })\n      }\n      clearAlert()\n    \n    }\n\n     const loginUser = async (currentUser ) => {\n        dispatch({ type: LOGIN_USER_BEGIN })\n        try {\n          const { data  } = await axios.post('/api/v1/auth/login', currentUser)\n          const { user, token } = data\n       \n          dispatch ({\n              type: LOGIN_USER_SUCCESS,\n              payload: { user, token},\n          })\n          addUserToLocalStorage({user, token})\n        } catch (error) {\n\n          dispatch({\n              type: LOGIN_USER_ERROR,\n              payload: { msg: error.response.data.msg}\n          })\n        }\n        clearAlert()\n      \n     }\n\nconst logoutUser = async () => {\n    // await authFetch.get(\"/auth/logout\")\n    dispatch({ type: LOGOUT_USER})\n    removeUserFromLocalStorage()\n}\n\nconst forgotpassword = async (forgotEmail) => {\n\n   \n    dispatch({ type: FORGOT_PASSWORD_BEGIN })\n    try {\n        const response = await  axios.post('/api/v1/auth/forgotpassword', forgotEmail)\n        toast.success(response.data)\n        \n    } catch (error) {\n        toast.error(error.response.data)\n  \n    }\n}\n\nconst resetPassword = async (details) => {\n   \n    dispatch({ type: RESET_PASSWORD_BEGIN })\n    try {\n        const response = await  axios.post('/api/v1/auth/updatepassword', details)\n        const { status } = response.data\n        (\"see response\", status);\n        \n        \n    } catch (error) {\n    \n        dispatch({\n            type: RESET_PASSWORD_ERROR,\n            payload: { msg: error.response.data.msg}\n        })\n    }\n}\n\n\n    return (\n        <AppContext.Provider value={{ ...state , displayAlert, registerUser, loginUser,logoutUser, passwordAlert, forgotpassword, resetPassword,resetAlert }}>{children}</AppContext.Provider>\n    )\n}\n\nconst useAppContext = () => {\n    return useContext(AppContext)\n}\n\nexport {AppProvider,initialState,useAppContext}"],"mappings":"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"},"metadata":{},"sourceType":"module"}